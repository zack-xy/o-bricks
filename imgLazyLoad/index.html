<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>图片懒加载</title>
  <style>
    img {
      display: block;
      margin-bottom: 50px;
      width: 400px;
      height: 400px;
    }
  </style>
</head>
<body>
  <img src="./img/loading.gif" data-src="./img/1.png" alt="">
  <img src="./img/loading.gif" data-src="./img/2.png" alt="">
  <img src="./img/loading.gif" data-src="./img/3.png" alt="">
  <img src="./img/loading.gif" data-src="./img/4.png" alt="">
  <img src="./img/loading.gif" data-src="./img/5.png" alt="">
  <img src="./img/loading.gif" data-src="./img/6.png" alt="">
  <img src="./img/loading.gif" data-src="./img/7.png" alt="">
  <img src="./img/loading.gif" data-src="./img/8.png" alt="">
  <img src="./img/loading.gif" data-src="./img/9.png" alt="">
  <script>
    let num = document.getElementsByTagName('img').length
    let img = document.getElementsByTagName('img')

    let n = 0

    lazyLoad()
    window.onscroll = lazyLoad

    function lazyLoad() {
      let seeHeight = document.documentElement.clientHeight  // 可见区域
      let scrollTop = document.documentElement.scrollTop || document.body.scrollTop // 滚动条滚动的距离  

      for(let i = n;i<num;i++) {
        if(img[i].offsetTop < seeHeight + scrollTop) {
          if(img[i].getAttribute('src') === './img/loading.gif') {
            img[i].src = img[i].getAttribute('data-src')
          }
          n = i + 1 // 防止加载过的图片重复加载r
        }
      }
    }
  </script>
</body>
</html>
